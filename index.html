<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DALMASO ‚Äî Gest√£o Escolar</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet" />
  <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css" />
</head>
<body>

<div class="d-flex" id="wrapper">
  <nav id="sidebar" class="sidebar">
    <div class="sidebar-header">
      <i class="bi bi-mortarboard-fill"></i>
      <span>DALMASO</span>
    </div>
    <ul class="sidebar-nav">
      <li class="active" data-page="inicio">
        <i class="bi bi-house-fill"></i> <span>In√≠cio</span>
      </li>
      <li data-page="alunos">
        <i class="bi bi-people-fill"></i> <span>Alunos</span>
      </li>
      <li data-page="relatorios">
        <i class="bi bi-graph-up"></i> <span>Relat√≥rios</span>
      </li>
      <li data-page="importar">
        <i class="bi bi-cloud-upload-fill"></i> <span>Importar Dados</span>
      </li>
      <li data-page="turmas">
        <i class="bi bi-collection-fill"></i> <span>Turmas</span>
      </li>
    </ul>
    <div class="sidebar-footer">
      <small>Gest√£o Escolar v2.0</small>
    </div>
  </nav>

  <main id="main-content" class="main-content">
    <button class="btn btn-sm btn-outline-secondary d-md-none mb-3" id="btnToggleSidebar">
      <i class="bi bi-list"></i>
    </button>

    <!-- IN√çCIO: Cards de Turmas -->
    <section id="page-inicio" class="page active">
      <h2 class="page-title"><i class="bi bi-house-fill"></i> S√©ries / Turmas</h2>
      <p class="text-muted mb-3">Selecione uma turma para registrar frequ√™ncia no calend√°rio</p>
      <div class="row g-3" id="grid-inicio"></div>
      <div id="inicio-vazio" class="text-center text-muted py-5" style="display:none;">
        <i class="bi bi-collection" style="font-size:3rem;"></i>
        <p class="mt-2">Nenhuma turma cadastrada. V√° em <strong>Turmas</strong> ou <strong>Importar</strong> para come√ßar.</p>
      </div>
    </section>

    <!-- CALEND√ÅRIO ANUAL -->
    <section id="page-calendario" class="page">
      <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-3">
        <div class="d-flex align-items-center gap-2">
          <button class="btn btn-outline-secondary btn-sm" id="btn-voltar-inicio"><i class="bi bi-arrow-left"></i></button>
          <h2 class="page-title mb-0"><i class="bi bi-calendar3"></i> <span id="titulo-calendario"></span></h2>
        </div>
        <div class="d-flex align-items-center gap-2">
          <button class="btn btn-sm btn-outline-primary" id="btn-ano-anterior"><i class="bi bi-chevron-left"></i></button>
          <span class="fw-bold fs-5" id="label-ano"></span>
          <button class="btn btn-sm btn-outline-primary" id="btn-ano-proximo"><i class="bi bi-chevron-right"></i></button>
        </div>
      </div>
      <div class="calendario-legenda mb-3">
        <span class="legenda-item"><span class="legenda-cor bg-dia-letivo"></span> Dia letivo</span>
        <span class="legenda-item"><span class="legenda-cor bg-dia-registrado"></span> Frequ√™ncia registrada</span>
        <span class="legenda-item"><span class="legenda-cor bg-dia-hoje"></span> Hoje</span>
        <span class="legenda-item"><span class="legenda-cor bg-dia-fds"></span> Fim de semana</span>
      </div>
      <div id="container-calendario"></div>
    </section>

    <!-- CHAMADA -->
    <section id="page-chamada" class="page">
      <div class="d-flex align-items-center gap-2 mb-3">
        <button class="btn btn-outline-secondary btn-sm" id="btn-voltar-calendario"><i class="bi bi-arrow-left"></i></button>
        <h2 class="page-title mb-0"><i class="bi bi-clipboard-check"></i> Chamada</h2>
      </div>
      <div class="card p-3 mb-3">
        <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
          <div>
            <span class="badge bg-primary fs-6 me-2" id="badge-turma-chamada"></span>
            <span class="badge bg-secondary fs-6" id="badge-data-chamada"></span>
          </div>
          <div>
            <button class="btn btn-outline-secondary btn-sm me-1" id="btn-marcar-todos"><i class="bi bi-check-all"></i> Todos Presentes</button>
            <button class="btn btn-outline-warning btn-sm me-2" id="btn-desmarcar-todos"><i class="bi bi-x-circle"></i> Todos Ausentes</button>
            <button class="btn btn-success" id="btn-salvar-chamada"><i class="bi bi-check-circle"></i> Salvar Chamada</button>
          </div>
        </div>
      </div>
      <div class="table-responsive">
        <table class="table table-hover" id="tabela-chamada">
          <thead>
            <tr>
              <th style="width:50px">N¬∫</th>
              <th>Nome do Aluno</th>
              <th>RA</th>
              <th class="text-center" style="width:110px">Presen√ßa</th>
              <th>Observa√ß√£o</th>
            </tr>
          </thead>
          <tbody id="corpo-tabela-chamada"></tbody>
        </table>
      </div>
    </section>

    <!-- ALUNOS -->
    <section id="page-alunos" class="page">
      <h2 class="page-title"><i class="bi bi-people-fill"></i> Alunos</h2>
      <div class="row mb-3">
        <div class="col-md-4">
          <select class="form-select" id="filtro-turma-alunos"><option value="">Todas as turmas</option></select>
        </div>
        <div class="col-md-4">
          <input type="text" class="form-control" id="busca-alunos" placeholder="Buscar por nome, RA ou CPF..." />
        </div>
        <div class="col-md-4 text-end">
          <button class="btn btn-primary" id="btn-novo-aluno"><i class="bi bi-plus-circle"></i> Novo Aluno</button>
        </div>
      </div>
      <div class="table-responsive">
        <table class="table table-hover" id="tabela-alunos">
          <thead><tr><th>N¬∫</th><th>Nome</th><th>RA</th><th>Turma</th><th>Nascimento</th><th>Sexo</th><th>A√ß√µes</th></tr></thead>
          <tbody id="corpo-tabela-alunos"></tbody>
        </table>
      </div>
      <div id="alunos-vazio" class="text-center text-muted py-5" style="display:none;">
        <i class="bi bi-inbox" style="font-size:3rem;"></i>
        <p class="mt-2">Nenhum aluno encontrado.</p>
      </div>
    </section>

    <!-- DETALHE DO ALUNO -->
    <section id="page-aluno-detalhe" class="page">
      <button class="btn btn-outline-secondary btn-sm mb-3" id="btn-voltar-alunos"><i class="bi bi-arrow-left"></i> Voltar</button>
      <div id="aluno-detalhe-conteudo"></div>
    </section>

    <!-- RELAT√ìRIOS -->
    <section id="page-relatorios" class="page">
      <h2 class="page-title"><i class="bi bi-graph-up"></i> Relat√≥rios</h2>
      <div class="row mb-3">
        <div class="col-md-4"><label class="form-label">Turma</label><select class="form-select" id="rel-turma"></select></div>
        <div class="col-md-3"><label class="form-label">M√™s</label><input type="month" class="form-control" id="rel-mes" /></div>
        <div class="col-md-3"><label class="form-label">Tipo</label>
          <select class="form-select" id="rel-tipo">
            <option value="frequencia">Frequ√™ncia Mensal</option>
            <option value="perfil">Perfil da Turma</option>
          </select>
        </div>
        <div class="col-md-2 d-flex align-items-end">
          <button class="btn btn-primary" id="btn-gerar-relatorio"><i class="bi bi-bar-chart-fill"></i> Gerar</button>
        </div>
      </div>
      <div id="relatorio-conteudo"></div>
    </section>

    <!-- IMPORTAR -->
    <section id="page-importar" class="page">
      <h2 class="page-title"><i class="bi bi-cloud-upload-fill"></i> Importar Dados</h2>
      <div class="card p-4" style="max-width:600px;">
        <p class="text-muted mb-3">Importe dados de alunos a partir de um arquivo Excel (.xlsx) ou CSV (.csv) gerado pela extens√£o Chrome do SED.</p>
        <div class="mb-3"><label class="form-label">Arquivo</label>
          <input type="file" class="form-control" id="input-arquivo" accept=".xlsx,.xls,.csv" /></div>
        <button class="btn btn-primary" id="btn-importar"><i class="bi bi-upload"></i> Importar</button>
        <div id="importar-progresso" class="mt-3" style="display:none;">
          <div class="progress"><div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width:100%"></div></div>
          <small class="text-muted mt-1">Processando arquivo...</small>
        </div>
        <div id="importar-resultado" class="mt-3"></div>
      </div>
    </section>

    <!-- TURMAS -->
    <section id="page-turmas" class="page">
      <h2 class="page-title"><i class="bi bi-collection-fill"></i> Turmas</h2>
      <div class="row mb-3">
        <div class="col-md-4">
          <div class="input-group">
            <input type="text" class="form-control" id="input-nova-turma" placeholder="Nome da turma (ex: 6A)" />
            <button class="btn btn-primary" id="btn-criar-turma"><i class="bi bi-plus"></i> Criar</button>
          </div>
        </div>
      </div>
      <div class="row g-3" id="grid-turmas"></div>
    </section>

  </main>
</div>

<!-- MODAL: ALUNO -->
<div class="modal fade" id="modalAluno" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalAlunoTitulo">Novo Aluno</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="form-aluno">
          <input type="hidden" id="aluno-id" />
          <div class="row g-3">
            <div class="col-md-8"><label class="form-label">Nome *</label><input type="text" class="form-control" id="aluno-nome" required /></div>
            <div class="col-md-4"><label class="form-label">Turma</label><select class="form-select" id="aluno-turma"></select></div>
            <div class="col-md-3"><label class="form-label">RA</label><input type="text" class="form-control" id="aluno-ra" /></div>
            <div class="col-md-3"><label class="form-label">Data de Nascimento</label><input type="text" class="form-control" id="aluno-nascimento" placeholder="dd/mm/aaaa" /></div>
            <div class="col-md-3"><label class="form-label">Sexo</label>
              <select class="form-select" id="aluno-sexo"><option value="">Selecione</option><option value="Masculino">Masculino</option><option value="Feminino">Feminino</option></select></div>
            <div class="col-md-3"><label class="form-label">Ra√ßa/Cor</label>
              <select class="form-select" id="aluno-raca"><option value="">Selecione</option><option value="Branca">Branca</option><option value="Preta">Preta</option><option value="Parda">Parda</option><option value="Amarela">Amarela</option><option value="Ind√≠gena">Ind√≠gena</option><option value="N√£o declarada">N√£o declarada</option></select></div>
            <div class="col-md-4"><label class="form-label">CPF</label><input type="text" class="form-control" id="aluno-cpf" /></div>
            <div class="col-md-4"><label class="form-label">Filia√ß√£o 1</label><input type="text" class="form-control" id="aluno-filiacao1" /></div>
            <div class="col-md-4"><label class="form-label">Filia√ß√£o 2</label><input type="text" class="form-control" id="aluno-filiacao2" /></div>
            <div class="col-md-4"><label class="form-label">Telefones</label><input type="text" class="form-control" id="aluno-telefones" /></div>
            <div class="col-md-4"><label class="form-label">E-Mail</label><input type="email" class="form-control" id="aluno-email" /></div>
            <div class="col-md-4"><label class="form-label">CEP</label><input type="text" class="form-control" id="aluno-cep" /></div>
            <div class="col-md-8"><label class="form-label">Endere√ßo</label><input type="text" class="form-control" id="aluno-endereco" /></div>
            <div class="col-md-4"><label class="form-label">Bairro</label><input type="text" class="form-control" id="aluno-bairro" /></div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary" id="btn-salvar-aluno"><i class="bi bi-check-circle"></i> Salvar</button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<!-- CHAT IA FLUTUANTE -->
<div id="ia-fab" class="ia-fab" title="Assistente IA">
  <i class="bi bi-robot"></i>
</div>

<div id="ia-panel" class="ia-panel" style="display:none;">
  <div class="ia-panel-header">
    <div class="d-flex align-items-center gap-2">
      <i class="bi bi-robot fs-5"></i>
      <strong>Assistente Pedag√≥gico</strong>
    </div>
    <button class="btn btn-sm btn-outline-light" id="ia-close"><i class="bi bi-x-lg"></i></button>
  </div>
  <div class="ia-panel-body" id="ia-mensagens">
    <div class="ia-msg ia-msg-bot">
      Ol√°! Sou o <strong>Assistente Pedag√≥gico DALMASO</strong>. üéì<br>
      Posso analisar frequ√™ncia, interpretar dados e sugerir interven√ß√µes. Como posso ajudar?
    </div>
  </div>
  <div class="ia-panel-actions mb-2 px-3">
    <button class="btn btn-sm btn-outline-primary ia-quick-btn" data-action="analisar">
      <i class="bi bi-bar-chart"></i> Analisar Frequ√™ncia
    </button>
    <button class="btn btn-sm btn-outline-primary ia-quick-btn" data-action="criticos">
      <i class="bi bi-exclamation-triangle"></i> Alunos Cr√≠ticos
    </button>
  </div>
  <div class="ia-panel-footer">
    <input type="text" class="form-control" id="ia-input" placeholder="Digite sua pergunta..." />
    <button class="btn btn-primary" id="ia-enviar"><i class="bi bi-send-fill"></i></button>
  </div>
</div>

<script src="/js/app.js"></script>
</body>
</html>
