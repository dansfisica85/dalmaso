<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dalmaso - Busca Ativa</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
  <nav class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <h2><i class="fas fa-school"></i> Dalmaso</h2>
      <span class="subtitle">Busca Ativa</span>
    </div>
    <ul class="nav-menu">
      <li class="nav-item active" data-page="dashboard">
        <i class="fas fa-home"></i> <span>Início</span>
      </li>
      <li class="nav-item" data-page="turmas">
        <i class="fas fa-users-rectangle"></i> <span>Turmas</span>
      </li>
      <li class="nav-item" data-page="alunos">
        <i class="fas fa-user-graduate"></i> <span>Alunos</span>
      </li>
      <li class="nav-item" data-page="chamada">
        <i class="fas fa-clipboard-check"></i> <span>Chamada</span>
      </li>
      <li class="nav-item" data-page="relatorios">
        <i class="fas fa-chart-bar"></i> <span>Relatórios</span>
      </li>
      <li class="nav-item" data-page="upload">
        <i class="fas fa-file-upload"></i> <span>Importar CSV</span>
      </li>
    </ul>
  </nav>

  <main class="main-content">
    <header class="top-bar">
      <button class="menu-toggle" id="menuToggle">
        <i class="fas fa-bars"></i>
      </button>
      <h1 id="pageTitle">Início</h1>
    </header>

    <div class="content-area">
      <!-- DASHBOARD -->
      <section class="page active" id="page-dashboard">
        <div class="stats-grid">
          <div class="stat-card">
            <i class="fas fa-users-rectangle"></i>
            <div>
              <span class="stat-number" id="statTurmas">0</span>
              <span class="stat-label">Turmas</span>
            </div>
          </div>
          <div class="stat-card">
            <i class="fas fa-user-graduate"></i>
            <div>
              <span class="stat-number" id="statAlunos">0</span>
              <span class="stat-label">Alunos</span>
            </div>
          </div>
          <div class="stat-card">
            <i class="fas fa-calendar-check"></i>
            <div>
              <span class="stat-number" id="statChamadasHoje">0</span>
              <span class="stat-label">Chamadas Hoje</span>
            </div>
          </div>
          <div class="stat-card">
            <i class="fas fa-percentage"></i>
            <div>
              <span class="stat-number" id="statFrequencia">-</span>
              <span class="stat-label">Frequência Geral</span>
            </div>
          </div>
        </div>
        <div class="card">
          <h3>Bem-vindo ao Sistema Dalmaso - Busca Ativa</h3>
          <p>Gerencie turmas, alunos e controle de frequência escolar.</p>
          <ul style="margin-top: 1rem; line-height: 2;">
            <li><strong>Turmas:</strong> Cadastre e gerencie turmas</li>
            <li><strong>Alunos:</strong> Cadastre, edite e exclua alunos</li>
            <li><strong>Chamada:</strong> Faça a chamada diária por turma e dia da semana</li>
            <li><strong>Relatórios:</strong> Visualize frequência dos alunos</li>
            <li><strong>Importar CSV:</strong> Importe turmas inteiras via arquivo CSV/XLSX</li>
          </ul>
        </div>
      </section>

      <!-- TURMAS -->
      <section class="page" id="page-turmas">
        <div class="card">
          <div class="card-header">
            <h3>Gerenciar Turmas</h3>
          </div>
          <form id="formTurma" class="inline-form">
            <input type="text" id="turmaNome" placeholder="Nome da turma (ex: 6A)" required>
            <input type="text" id="turmaDescricao" placeholder="Descrição (opcional)">
            <button type="submit" class="btn btn-primary"><i class="fas fa-plus"></i> Adicionar</button>
          </form>
          <table class="data-table" id="tabelaTurmas">
            <thead>
              <tr>
                <th>ID</th>
                <th>Nome</th>
                <th>Descrição</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <!-- ALUNOS -->
      <section class="page" id="page-alunos">
        <div class="card">
          <div class="card-header">
            <h3>Gerenciar Alunos</h3>
            <div class="header-actions">
              <select id="filtroTurmaAluno" class="select-input">
                <option value="">Todas as turmas</option>
              </select>
              <button class="btn btn-success" id="btnExportarAlunos"><i class="fas fa-download"></i> Exportar CSV</button>
            </div>
          </div>

          <!-- Modal/Form para cadastro -->
          <div class="form-card" id="formAlunoContainer">
            <h4 id="formAlunoTitle">Cadastrar Aluno</h4>
            <form id="formAluno" class="form-grid">
              <input type="hidden" id="alunoId">
              <div class="form-group">
                <label for="alunoNome">Nome completo *</label>
                <input type="text" id="alunoNome" required placeholder="Nome do aluno">
              </div>
              <div class="form-group">
                <label for="alunoMatricula">Matrícula</label>
                <input type="text" id="alunoMatricula" placeholder="Número de matrícula">
              </div>
              <div class="form-group">
                <label for="alunoTurma">Turma *</label>
                <select id="alunoTurma" required class="select-input">
                  <option value="">Selecione...</option>
                </select>
              </div>
              <div class="form-actions">
                <button type="submit" class="btn btn-primary" id="btnSalvarAluno">
                  <i class="fas fa-save"></i> Salvar
                </button>
                <button type="button" class="btn btn-secondary" id="btnCancelarAluno">
                  <i class="fas fa-times"></i> Cancelar
                </button>
              </div>
            </form>
          </div>

          <button class="btn btn-primary" id="btnNovoAluno" style="margin-bottom: 1rem;">
            <i class="fas fa-plus"></i> Novo Aluno
          </button>

          <table class="data-table" id="tabelaAlunos">
            <thead>
              <tr>
                <th>Nome</th>
                <th>Matrícula</th>
                <th>Turma</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <!-- CHAMADA -->
      <section class="page" id="page-chamada">
        <div class="card">
          <div class="card-header">
            <h3>Fazer Chamada</h3>
          </div>

          <div class="chamada-config">
            <div class="form-group">
              <label for="chamadaTurma">Turma *</label>
              <select id="chamadaTurma" required class="select-input">
                <option value="">Selecione a turma...</option>
              </select>
            </div>
            <div class="form-group">
              <label for="chamadaData">Data *</label>
              <input type="date" id="chamadaData" required>
            </div>
            <div class="form-group">
              <label>Dia da Semana</label>
              <div class="dias-semana" id="diasSemana">
                <button type="button" class="dia-btn" data-dia="Segunda">Seg</button>
                <button type="button" class="dia-btn" data-dia="Terça">Ter</button>
                <button type="button" class="dia-btn" data-dia="Quarta">Qua</button>
                <button type="button" class="dia-btn" data-dia="Quinta">Qui</button>
                <button type="button" class="dia-btn" data-dia="Sexta">Sex</button>
                <button type="button" class="dia-btn" data-dia="Sábado">Sáb</button>
              </div>
            </div>
            <button class="btn btn-primary" id="btnCarregarChamada">
              <i class="fas fa-list"></i> Carregar Alunos
            </button>
          </div>

          <div id="chamadaListaContainer" style="display:none;">
            <div class="chamada-actions">
              <button class="btn btn-success btn-sm" id="btnTodosPresentes">
                <i class="fas fa-check-double"></i> Todos Presentes
              </button>
              <button class="btn btn-danger btn-sm" id="btnTodosFaltaram">
                <i class="fas fa-times"></i> Todos Faltaram
              </button>
            </div>

            <div class="chamada-lista" id="chamadaLista"></div>

            <button class="btn btn-primary btn-lg" id="btnSalvarChamada">
              <i class="fas fa-save"></i> Salvar Chamada
            </button>
          </div>
        </div>
      </section>

      <!-- RELATÓRIOS -->
      <section class="page" id="page-relatorios">
        <div class="card">
          <div class="card-header">
            <h3>Relatórios de Frequência</h3>
            <div class="header-actions">
              <select id="relatorioTurma" class="select-input">
                <option value="">Todas as turmas</option>
              </select>
              <select id="relatorioMes" class="select-input">
                <option value="">Todos os meses</option>
                <option value="01">Janeiro</option>
                <option value="02">Fevereiro</option>
                <option value="03">Março</option>
                <option value="04">Abril</option>
                <option value="05">Maio</option>
                <option value="06">Junho</option>
                <option value="07">Julho</option>
                <option value="08">Agosto</option>
                <option value="09">Setembro</option>
                <option value="10">Outubro</option>
                <option value="11">Novembro</option>
                <option value="12">Dezembro</option>
              </select>
              <input type="number" id="relatorioAno" class="select-input" placeholder="Ano" value="2026" min="2020" max="2030" style="width: 100px;">
              <button class="btn btn-primary" id="btnGerarRelatorio">
                <i class="fas fa-search"></i> Buscar
              </button>
              <button class="btn btn-success" id="btnExportarFrequencia">
                <i class="fas fa-download"></i> Exportar
              </button>
            </div>
          </div>

          <table class="data-table" id="tabelaRelatorio">
            <thead>
              <tr>
                <th>Aluno</th>
                <th>Turma</th>
                <th>Data</th>
                <th>Dia</th>
                <th>Status</th>
                <th>Observação</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <!-- UPLOAD -->
      <section class="page" id="page-upload">
        <div class="card">
          <div class="card-header">
            <h3>Importar Alunos via CSV/XLSX</h3>
          </div>
          <div class="upload-area">
            <div class="upload-info">
              <i class="fas fa-info-circle"></i>
              <p>O arquivo deve ter pelo menos uma coluna com o nome do aluno. 
                 Colunas reconhecidas automaticamente: <strong>nome/aluno</strong>, <strong>matricula/ra</strong>.</p>
              <p>Formatos aceitos: <strong>.csv</strong> e <strong>.xlsx</strong></p>
            </div>
            <form id="formUpload" class="upload-form">
              <div class="form-group">
                <label for="uploadTurma">Turma de destino *</label>
                <select id="uploadTurma" required class="select-input">
                  <option value="">Selecione a turma...</option>
                </select>
              </div>
              <div class="form-group">
                <label for="uploadArquivo">Arquivo CSV ou XLSX *</label>
                <div class="file-input-wrapper">
                  <input type="file" id="uploadArquivo" accept=".csv,.xlsx,.xls" required>
                </div>
              </div>
              <button type="submit" class="btn btn-primary btn-lg">
                <i class="fas fa-upload"></i> Importar Alunos
              </button>
            </form>
            <div id="uploadResultado" class="upload-resultado" style="display:none;"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- Toast notification -->
  <div class="toast-container" id="toastContainer"></div>

  <script src="js/app.js"></script>
</body>
</html>
